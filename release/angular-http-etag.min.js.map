{"version":3,"file":null,"sources":["../src/service.js","../src/httpDecorator.js","../src/httpInterceptor.js","../src/cacheServiceAdapters.js","../node_modules/deepcopy/lib/polyfill.js","../node_modules/deepcopy/lib/copy.js","../node_modules/deepcopy/lib/index.js","../node_modules/deepcopy/index.js","../node_modules/object-keys/isArguments.js","../node_modules/object-keys/index.js","../node_modules/array-map/index.js","../src/index.js"],"sourcesContent":["'use strict'\n\nimport angular from 'angular'\nimport deepcopy from 'deepcopy'\n\nexport default httpEtagProvider\n\nfunction httpEtagProvider () {\n  var httpEtagProvider = this\n\n  var serviceAdapterMethods = [\n    'createCache',\n    'getCache'\n  ]\n\n  var cacheAdapterMethods = [\n    'setItem',\n    'getItem',\n    'removeItem',\n    'removeAllItems'\n    // info method hard-coded\n  ]\n\n  var requiredAdapterMethods = serviceAdapterMethods.concat(cacheAdapterMethods)\n\n  // Built-in adapters defined in ./cacheServiceAdapters.js\n  var cacheAdapters = {}\n  var cacheDefinitions = {}\n\n  // Cache config defaults\n  var defaultCacheId = 'httpEtagCache'\n  var defaultEtagCacheConfig = {\n    deepCopy: false,\n    cacheResponseData: true,\n    cacheService: '$cacheFactory',\n    cacheOptions: {\n      number: 25\n    }\n  }\n\n  /**\n   * SERVICE PROVIDER\n   * .setDefaultCacheConfig(config)\n   * .defineCache(cacheId, config)\n   * .defineCacheServiceAdapter(serviceName, config)\n   * .getCacheServiceAdapter(serviceName)\n   */\n\n  httpEtagProvider.setDefaultCacheConfig = function httpEtagSetDefaultCacheOptions (config) {\n    defaultEtagCacheConfig = angular.extend({}, defaultEtagCacheConfig, config)\n    return httpEtagProvider\n  }\n\n  httpEtagProvider.getDefaultCacheConfig = function httpEtagGetDefaultCacheOptions () {\n    return defaultEtagCacheConfig\n  }\n\n  httpEtagProvider.defineCache = function httpEtagDefineCache (cacheId, config) {\n    config = angular.extend({}, defaultEtagCacheConfig, config, { id: cacheId })\n    cacheDefinitions[cacheId] = config\n    return httpEtagProvider\n  }\n\n  httpEtagProvider.defineCacheServiceAdapter = function httpEtagDefineCacheServiceAdapter (serviceName, config) {\n    if (!config) throw new Error('Missing cache service adapter configuration')\n    if (!config.methods) throw new Error('Missing cache service adapter configuration methods')\n    angular.forEach(requiredAdapterMethods, function (method) {\n      if (typeof config.methods[method] !== 'function') {\n        throw new Error('Expected cache service adapter method \"' + method + '\" to be a function')\n      }\n    })\n\n    cacheAdapters[serviceName] = config\n    return httpEtagProvider\n  }\n\n  httpEtagProvider.getCacheServiceAdapter = function httpEtagGetCacheServiceAdapter (serviceName) {\n    return cacheAdapters[serviceName]\n  }\n\n  /**\n   * SERVICE\n   * .info()\n   * .getCache(acheId)\n   * .getItemCache(cacheId, itemKey)\n   */\n\n  httpEtagProvider.$get = ['$injector', function httpEtagFactory ($injector) {\n    var httpEtagService = {}\n\n    var services = {}\n    var adaptedServices = {}\n    var caches = {}\n    var adaptedCaches = {}\n\n    // Add default cache if not already defined\n    if (!cacheDefinitions[defaultCacheId]) httpEtagProvider.defineCache(defaultCacheId)\n\n    // Find/inject cache service and create adapted versions\n    angular.forEach(cacheAdapters, function adaptCacheService (adapter, serviceName) {\n      var service = services[serviceName] = window[serviceName] || $injector.get(serviceName)\n      var adaptedService = adaptedServices[serviceName] = {}\n\n      angular.forEach(serviceAdapterMethods, function (method) {\n        adaptedService[method] = angular.bind({}, adapter.methods[method], service)\n      })\n    })\n\n    // Instantiate caches and create adapted versions\n    angular.forEach(cacheDefinitions, function adaptCache (config, cacheId) {\n      adaptedServices[config.cacheService].createCache(cacheId, config)\n      var cache = caches[cacheId] = adaptedServices[config.cacheService].getCache(cacheId)\n      var adaptedCache = adaptedCaches[cacheId] = {}\n      // Determine whether to perform deepcopying or not\n      var serviceDeepCopies = cacheAdapters[config.cacheService].config.storesDeepCopies\n      var deepCopy = !serviceDeepCopies && cacheDefinitions[cacheId].deepCopy\n      var copy = function (value) {\n        return deepCopy ? deepcopy(value) : value\n      }\n\n      angular.forEach(cacheAdapterMethods, function (method) {\n        var adapterMethod = cacheAdapters[config.cacheService].methods[method]\n        var wrappedMethod\n        var wrappedRawMethod\n\n        // Wrap set/get methods to set/get to the `responseData` property of an\n        // object. This is where the $http interceptor stores response data.\n        if (method === 'getItem') {\n          wrappedMethod = function getCacheItemResponseData (cache, itemKey, options) {\n            var cachedData = adapterMethod(cache, itemKey, options)\n            return cachedData && copy(cachedData.responseData)\n          }\n\n          wrappedRawMethod = function getCacheItemData (cache, itemKey, options) {\n            return copy(adapterMethod(cache, itemKey, options))\n          }\n        }\n\n        if (method === 'setItem') {\n          wrappedMethod = function setCacheItemResponseData (cache, itemKey, value, options) {\n            var cachedData = adaptedCache.$getItem(itemKey)\n            value = copy(value)\n\n            if (cachedData && typeof cachedData === 'object') {\n              cachedData.responseData = value\n              value = cachedData\n            } else value = { responseData: value }\n\n            adapterMethod(cache, itemKey, value, options)\n          }\n\n          wrappedRawMethod = function setCacheItemData (cache, itemKey, value, options) {\n            adapterMethod(cache, itemKey, copy(value), options)\n          }\n        }\n\n        adaptedCache[method] = angular.bind({}, (wrappedMethod || adapterMethod), cache)\n        if (wrappedRawMethod) {\n          adaptedCache['$' + method] = angular.bind({}, wrappedRawMethod, cache)\n        }\n      })\n\n      adaptedCache.unsetItem = function adaptedCacheUnsetItemCache (itemKey) {\n        adaptedCache.setItem(itemKey, undefined)\n      }\n      adaptedCache.expireItem = function adaptedCacheUnsetItemCache (itemKey) {\n        var data = adaptedCache.$getItem(itemKey)\n        delete data.etagHeader\n        adaptedCache.$setItem(itemKey, data)\n      }\n      adaptedCache.getItemCache = function adaptedCacheGetItemCache (itemKey) {\n        return httpEtagService.getItemCache(cacheId, itemKey)\n      }\n      adaptedCache.info = function adaptedCacheInfo () {\n        return cacheDefinitions[cacheId]\n      }\n      adaptedCache.isCache = true\n    })\n\n    httpEtagService.info = function httpEtagServiceInfo () {\n      return cacheDefinitions\n    }\n\n    httpEtagService.getCache = function httpEtagServiceGetCache (cacheId) {\n      var cache = adaptedCaches[processCacheId(cacheId)]\n      if (cache) return cache\n    }\n\n    httpEtagService.getItemCache = function httpEtagServiceGeItemCache (cacheId, itemKey) {\n      var cache = httpEtagService.getCache(cacheId)\n      var itemCache = {}\n      if (!cache) return\n\n      var methodMappings = [\n        ['set', 'setItem'],\n        ['get', 'getItem'],\n        ['$set', '$setItem'],\n        ['$get', '$getItem'],\n        ['unset', 'unsetItem'],\n        ['expire', 'expireItem'],\n        ['remove', 'removeItem']\n      ]\n\n      angular.forEach(methodMappings, function mapCacheMethdodsToItemCache (methods) {\n        itemCache[methods[0]] = angular.bind({}, cache[methods[1]], itemKey)\n      })\n\n      itemCache.info = function itemCacheInfo () {\n        var itemCacheInfo = cache.info()\n        itemCacheInfo.itemKey = itemKey\n        return itemCacheInfo\n      }\n\n      itemCache.isItemCache = true\n\n      return itemCache\n    }\n\n    httpEtagService.purgeCaches = function httpEtagPurgeCaches () {\n      angular.forEach(adaptedCaches, function (cache) {\n        cache.removeAllItems()\n      })\n    }\n\n    function processCacheId (cacheId) {\n      var type = typeof cacheId\n      var isDefined = type === 'number' || (type === 'string' && !!cacheId)\n      return isDefined ? cacheId : defaultCacheId\n    }\n\n    return httpEtagService\n  }]\n}\n","'use strict'\n\nimport angular from 'angular'\nimport objectKeys from 'object-keys'\nimport arrayMap from 'array-map'\n\nexport default httpEtagHttpDecorator\n\nhttpEtagHttpDecorator.$inject = ['$delegate', 'httpEtag']\n\nfunction httpEtagHttpDecorator ($delegate, httpEtag) {\n  var $http = $delegate\n  var cachableHttpMethods = [\n    'GET',\n    'JSONP'\n  ]\n\n  function $httpDecorator (httpConfig) {\n    var hasConfig = !!httpConfig.etagCache\n    var isCacheableMethod = cachableHttpMethods.indexOf(httpConfig.method) >= 0\n    var isCachable = hasConfig && isCacheableMethod\n    var httpPromise\n\n    if (isCachable) {\n      var etagCacheConfig = processHttpConfigEtagValue(httpConfig)\n      if (etagCacheConfig) {\n        var itemCache = httpEtag.getItemCache(etagCacheConfig.id, etagCacheConfig.itemKey)\n        if (!itemCache) throw new Error('No defined ETag caches match specified cache ID')\n\n        var cacheInfo = itemCache.info()\n        var rawCacheData = itemCache.$get()\n        var cachedEtag = rawCacheData && rawCacheData.etagHeader\n        var cachedResponse = cachedEtag && rawCacheData.responseData\n\n        // Allow easy access to cache in interceptor\n        httpConfig.$$_itemCache = itemCache\n\n        if (cachedEtag) {\n          httpConfig.headers = angular.extend({}, httpConfig.headers, {\n            'If-None-Match': cachedEtag\n          })\n        }\n      }\n    }\n\n    httpPromise = $http.apply($http, arguments)\n\n    httpPromise.cached = function httpEtagPromiseCached (callback) {\n      if (isCachable && rawCacheData && cacheInfo.cacheResponseData) callback(cachedResponse, 'cached', undefined, httpConfig, itemCache)\n      return httpPromise\n    }\n\n    if (itemCache) {\n      var onSuccess = httpPromise.success\n      httpPromise.success = function httpEtagPromiseSuccess (callback) {\n        var partializedCallback = partial(callback, undefined, undefined, undefined, undefined, itemCache)\n        return onSuccess(partializedCallback)\n      }\n    }\n\n    return httpPromise\n  }\n\n  // Decorate the cachable shortcut methods, too\n  angular.forEach(cachableHttpMethods, function (httpMethod) {\n    var method = httpMethod.toLowerCase()\n    $httpDecorator[method] = function httpEtagHttpShortcutWrapper (url, config) {\n      config = angular.extend({}, config, {\n        method: httpMethod,\n        url: url\n      })\n\n      return $httpDecorator.call($http, config)\n    }\n  })\n\n  // Copy over all other properties and methods\n  angular.forEach($http, function copyHttpPropertyToDectorator (value, key) {\n    if (!$httpDecorator[key]) $httpDecorator[key] = value\n  })\n\n  /**\n   * HELPERS\n   */\n\n  function processHttpConfigEtagValue (httpConfig) {\n    var etagValue = httpConfig.etagCache\n    var etagValueType = typeof etagValue\n    var etagCacheConfig = {}\n\n    // Evaluate function first\n    if (etagValueType === 'function') {\n      etagValue = etagValue(httpConfig)\n      etagValueType = typeof etagValue\n    }\n\n    // Plain, cache, or itemCache objects\n    if (etagValueType === 'object') {\n      var id, itemKey\n\n      if (etagValue.isCache) {\n        id = etagValue.info().id\n        itemKey = generateCacheItemKey(httpConfig)\n      } else if (etagValue.isItemCache) {\n        id = etagValue.info().id\n        itemKey = etagValue.info().itemKey\n      } else {\n        id = etagValue.id\n        itemKey = etagValue.itemKey || generateCacheItemKey(httpConfig)\n      }\n\n      etagCacheConfig.id = id\n      etagCacheConfig.itemKey = itemKey\n    } else if (etagValueType === 'string') {\n      etagCacheConfig.id = etagValue\n      etagCacheConfig.itemKey = generateCacheItemKey(httpConfig)\n    } else if (etagValue === true) {\n      // Undefined cacheId will use the default cacheId as defined in provider\n      etagCacheConfig.itemKey = generateCacheItemKey(httpConfig)\n    } else return\n    return etagCacheConfig\n  }\n\n  function generateCacheItemKey (httpConfig) {\n    var url = httpConfig.url\n    var params = stringifyParams(httpConfig.params)\n    var joiner = ((params && url.indexOf('?') > 0) ? '&' : '?')\n    var queryString = (params && joiner + params) || ''\n    return url + queryString\n  }\n\n  // Based on npm package \"query-string\"\n  function stringifyParams (obj) {\n    return obj ? arrayMap(objectKeys(obj).sort(), function (key) {\n      var val = obj[key]\n\n      if (angular.isArray(val)) {\n        return arrayMap(val.sort(), function (val2) {\n          return encodeURIComponent(key) + '=' + encodeURIComponent(val2)\n        }).join('&')\n      }\n\n      return encodeURIComponent(key) + '=' + encodeURIComponent(val)\n    }).join('&') : ''\n  }\n\n  // http://ejohn.org/blog/partial-functions-in-javascript/\n  function partial (fn) {\n    var args = Array.prototype.slice.call(arguments, 1)\n    return function () {\n      var arg = 0\n      for (var i = 0; i < args.length && arg < arguments.length; i++) {\n        if (args[i] === undefined) args[i] = arguments[arg++]\n      }\n      return fn.apply(this, args)\n    }\n  }\n\n  return $httpDecorator\n}\n","'use strict'\n\nexport default httpEtagInterceptorFactory\n\nfunction httpEtagInterceptorFactory () {\n  function responseInterceptor (response) {\n    var itemCache = response.config.$$_itemCache\n\n    if (itemCache) {\n      var cacheInfo = itemCache.info()\n      var cacheResponseData = cacheInfo.cacheResponseData\n      var etag = response.headers().etag\n      var cacheData = {}\n\n      if (etag) {\n        cacheData.etagHeader = etag\n        if (cacheResponseData) cacheData.responseData = response.data\n        itemCache.$set(cacheData)\n      }\n\n      delete response.config.$$_itemCache\n    }\n\n    return response\n  }\n\n  return {\n    response: responseInterceptor\n  }\n}\n","'use strict'\n\nimport angular from 'angular'\n\nexport default cacheAdaptersConfig\n\ncacheAdaptersConfig.$inject = ['httpEtagProvider']\n\nfunction cacheAdaptersConfig (httpEtagProvider) {\n  httpEtagProvider\n\n    .defineCacheServiceAdapter('$cacheFactory', {\n      config: {\n        storesDeepCopies: false\n      },\n      methods: {\n        createCache: function createCache ($cacheFactory, cacheId, options) {\n          $cacheFactory(cacheId, options)\n        },\n        getCache: function getCache ($cacheFactory, cacheId) {\n          return $cacheFactory.get(cacheId)\n        },\n        setItem: function setItem (cache, itemKey, value) {\n          cache.put(itemKey, value)\n        },\n        getItem: function getItem (cache, itemKey) {\n          return cache.get(itemKey)\n        },\n        removeItem: function removeItem (cache, itemKey) {\n          cache.remove(itemKey)\n        },\n        removeAllItems: function removeAllItems (cache, itemKey) {\n          cache.removeAll()\n        }\n      }\n    })\n\n    .defineCacheServiceAdapter('localStorage', {\n      config: {\n        storesDeepCopies: true\n      },\n      methods: {\n        createCache: angular.noop,\n        getCache: function getCache (localStorage, cacheId) {\n          return cacheId\n        },\n        setItem: function setItem (cacheId, itemKey, value) {\n          itemKey = cacheId + ':' + itemKey\n          localStorage.setItem(itemKey, JSON.stringify(value))\n        },\n        getItem: function getItem (cacheId, itemKey) {\n          itemKey = cacheId + ':' + itemKey\n          return JSON.parse(localStorage.getItem(itemKey))\n        },\n        removeItem: function removeItem (cacheId, itemKey) {\n          itemKey = cacheId + ':' + itemKey\n          localStorage.removeItem(itemKey)\n        },\n        removeAllItems: function removeAllItems (cacheId, itemKey) {\n          var keyPrefix = cacheId + ':'\n\n          angular.forEach(localStorage, function (value, key) {\n            if (key.indexOf(keyPrefix) === 0) {\n              localStorage.removeItem(key)\n            }\n          })\n        }\n      }\n    })\n\n    .defineCacheServiceAdapter('sessionStorage', {\n      config: {\n        storesDeepCopies: true\n      },\n      methods: {\n        createCache: angular.noop,\n        getCache: function getCache (sessionStorage, cacheId) {\n          return cacheId\n        },\n        setItem: function setItem (cacheId, itemKey, value) {\n          itemKey = cacheId + ':' + itemKey\n          sessionStorage.setItem(itemKey, JSON.stringify(value))\n        },\n        getItem: function getItem (cacheId, itemKey) {\n          itemKey = cacheId + ':' + itemKey\n          return JSON.parse(sessionStorage.getItem(itemKey))\n        },\n        removeItem: function removeItem (cacheId, itemKey) {\n          itemKey = cacheId + ':' + itemKey\n          sessionStorage.removeItem(itemKey)\n        },\n        removeAllItems: function removeAllItems (cacheId, itemKey) {\n          var keyPrefix = cacheId + ':'\n\n          angular.forEach(sessionStorage, function (value, key) {\n            if (key.indexOf(keyPrefix) === 0) {\n              sessionStorage.removeItem(key)\n            }\n          })\n        }\n      }\n    })\n}\n","'use strict';\n\nexports.__esModule = true;\nvar toString = Object.prototype.toString;\n\nvar isBuffer = typeof Buffer !== 'undefined' ? function isBuffer(obj) {\n  return Buffer.isBuffer(obj);\n} : function isBuffer() {\n  // always return false in browsers\n  return false;\n};\n\nvar getKeys = typeof Object.keys === 'function' ? function getKeys(obj) {\n  return Object.keys(obj);\n} : function getKeys(obj) {\n  var objType = typeof obj;\n\n  if (obj === null || objType !== 'function' && objType !== 'object') {\n    throw new TypeError('obj must be an Object');\n  }\n\n  var resultKeys = [],\n      key = void 0;\n\n  for (key in obj) {\n    Object.prototype.hasOwnProperty.call(obj, key) && resultKeys.push(key);\n  }\n\n  return resultKeys;\n};\n\nvar getSymbols = typeof Symbol === 'function' ? function getSymbols(obj) {\n  return Object.getOwnPropertySymbols(obj);\n} : function getSymbols() {\n  // always return empty Array when Symbol is not supported\n  return [];\n};\n\n// NOTE:\n//\n//   Array.prototype.indexOf is cannot find NaN (in Chrome)\n//   Array.prototype.includes is can find NaN (in Chrome)\n//\n//   this function can find NaN, because use SameValue algorithm\nfunction indexOf(array, s) {\n  if (toString.call(array) !== '[object Array]') {\n    throw new TypeError('array must be an Array');\n  }\n\n  var i = void 0,\n      len = void 0,\n      value = void 0;\n\n  for (i = 0, len = array.length; i < len; ++i) {\n    value = array[i];\n\n    // NOTE:\n    //\n    //   it is SameValue algorithm\n    //   http://stackoverflow.com/questions/27144277/comparing-a-variable-with-itself\n    //\n    // eslint-disable-next-line no-self-compare\n    if (value === s || value !== value && s !== s) {\n      return i;\n    }\n  }\n\n  return -1;\n}\n\nexports.getKeys = getKeys;\nexports.getSymbols = getSymbols;\nexports.indexOf = indexOf;\nexports.isBuffer = isBuffer;","'use strict';\n\nexports.__esModule = true;\nexports.copyValue = exports.copyCollection = exports.copy = void 0;\n\nvar _polyfill = require('./polyfill');\n\nvar toString = Object.prototype.toString;\n\nfunction copy(target, customizer) {\n  var resultValue = copyValue(target);\n\n  if (resultValue !== null) {\n    return resultValue;\n  }\n\n  return copyCollection(target, customizer);\n}\n\nfunction copyCollection(target, customizer) {\n  if (typeof customizer !== 'function') {\n    throw new TypeError('customizer is must be a Function');\n  }\n\n  if (typeof target === 'function') {\n    var source = String(target);\n\n    // NOTE:\n    //\n    //   https://gist.github.com/jdalton/5e34d890105aca44399f\n    //\n    //   - https://gist.github.com/jdalton/5e34d890105aca44399f#gistcomment-1283831\n    //   - http://es5.github.io/#x15\n    //\n    //   native functions does not have prototype:\n    //\n    //       Object.toString.prototype  // => undefined\n    //       (function() {}).prototype  // => {}\n    //\n    //   but cannot detect native constructor:\n    //\n    //       typeof Object     // => 'function'\n    //       Object.prototype  // => {}\n    //\n    //   and cannot detect null binded function:\n    //\n    //       String(Math.abs)\n    //         // => 'function abs() { [native code] }'\n    //\n    //     Firefox, Safari:\n    //       String((function abs() {}).bind(null))\n    //         // => 'function abs() { [native code] }'\n    //\n    //     Chrome:\n    //       String((function abs() {}).bind(null))\n    //         // => 'function () { [native code] }'\n    if (/^\\s*function\\s*\\S*\\([^\\)]*\\)\\s*{\\s*\\[native code\\]\\s*}/.test(source)) {\n      // native function\n      return target;\n    } else {\n      // user defined function\n      return new Function('return ' + String(source))();\n    }\n  }\n\n  var targetClass = toString.call(target);\n\n  if (targetClass === '[object Array]') {\n    return [];\n  }\n\n  if (targetClass === '[object Object]' && target.constructor === Object) {\n    return {};\n  }\n\n  if (targetClass === '[object Date]') {\n    // NOTE:\n    //\n    //   Firefox need to convert\n    //\n    //   Firefox:\n    //     var date = new Date;\n    //     +date;            // 1420909365967\n    //     +new Date(date);  // 1420909365000\n    //     +new Date(+date); // 1420909365967\n    //\n    //   Chrome:\n    //     var date = new Date;\n    //     +date;            // 1420909757913\n    //     +new Date(date);  // 1420909757913\n    //     +new Date(+date); // 1420909757913\n    return new Date(target.getTime());\n  }\n\n  if (targetClass === '[object RegExp]') {\n    // NOTE:\n    //\n    //   Chrome, Safari:\n    //     (new RegExp).source => \"(?:)\"\n    //\n    //   Firefox:\n    //     (new RegExp).source => \"\"\n    //\n    //   Chrome, Safari, Firefox:\n    //     String(new RegExp) => \"/(?:)/\"\n    var regexpText = String(target),\n        slashIndex = regexpText.lastIndexOf('/');\n\n    return new RegExp(regexpText.slice(1, slashIndex), regexpText.slice(slashIndex + 1));\n  }\n\n  if ((0, _polyfill.isBuffer)(target)) {\n    var buffer = new Buffer(target.length);\n\n    target.copy(buffer);\n\n    return buffer;\n  }\n\n  var customizerResult = customizer(target);\n\n  if (customizerResult !== void 0) {\n    return customizerResult;\n  }\n\n  return null;\n}\n\nfunction copyValue(target) {\n  var targetType = typeof target;\n\n  // copy String, Number, Boolean, undefined and Symbol\n  // without null and Function\n  if (target !== null && targetType !== 'object' && targetType !== 'function') {\n    return target;\n  }\n\n  return null;\n}\n\nexports.copy = copy;\nexports.copyCollection = copyCollection;\nexports.copyValue = copyValue;","'use strict';\n\nexports.__esModule = true;\n\nvar _copy = require('./copy');\n\nvar _polyfill = require('./polyfill');\n\nfunction defaultCustomizer(target) {\n  return void 0;\n}\n\nfunction deepcopy(target) {\n  var customizer = arguments.length <= 1 || arguments[1] === void 0 ? defaultCustomizer : arguments[1];\n\n  if (target === null) {\n    // copy null\n    return null;\n  }\n\n  var resultValue = (0, _copy.copyValue)(target);\n\n  if (resultValue !== null) {\n    // copy some primitive types\n    return resultValue;\n  }\n\n  var resultCollection = (0, _copy.copyCollection)(target, customizer),\n      clone = resultCollection !== null ? resultCollection : target;\n\n  var visited = [target],\n      reference = [clone];\n\n  // recursively copy from collection\n  return recursiveCopy(target, customizer, clone, visited, reference);\n}\n\nfunction recursiveCopy(target, customizer, clone, visited, reference) {\n  if (target === null) {\n    // copy null\n    return null;\n  }\n\n  var resultValue = (0, _copy.copyValue)(target);\n\n  if (resultValue !== null) {\n    // copy some primitive types\n    return resultValue;\n  }\n\n  var keys = (0, _polyfill.getKeys)(target).concat((0, _polyfill.getSymbols)(target));\n\n  var i = void 0,\n      len = void 0;\n\n  var key = void 0,\n      value = void 0,\n      index = void 0,\n      resultCopy = void 0,\n      result = void 0,\n      ref = void 0;\n\n  for (i = 0, len = keys.length; i < len; ++i) {\n    key = keys[i];\n    value = target[key];\n    index = (0, _polyfill.indexOf)(visited, value);\n\n    resultCopy = void 0;\n    result = void 0;\n    ref = void 0;\n\n    if (index === -1) {\n      resultCopy = (0, _copy.copy)(value, customizer);\n      result = resultCopy !== null ? resultCopy : value;\n\n      if (value !== null && /^(?:function|object)$/.test(typeof value)) {\n        visited.push(value);\n        reference.push(result);\n      }\n    } else {\n      // circular reference\n      ref = reference[index];\n    }\n\n    clone[key] = ref || recursiveCopy(value, customizer, result, visited, reference);\n  }\n\n  return clone;\n}\n\nexports['default'] = deepcopy;\nmodule.exports = exports['default'];","module.exports = require('./lib');\n","'use strict';\n\nvar toStr = Object.prototype.toString;\n\nmodule.exports = function isArguments(value) {\n\tvar str = toStr.call(value);\n\tvar isArgs = str === '[object Arguments]';\n\tif (!isArgs) {\n\t\tisArgs = str !== '[object Array]' &&\n\t\t\tvalue !== null &&\n\t\t\ttypeof value === 'object' &&\n\t\t\ttypeof value.length === 'number' &&\n\t\t\tvalue.length >= 0 &&\n\t\t\ttoStr.call(value.callee) === '[object Function]';\n\t}\n\treturn isArgs;\n};\n","'use strict';\n\n// modified from https://github.com/es-shims/es5-shim\nvar has = Object.prototype.hasOwnProperty;\nvar toStr = Object.prototype.toString;\nvar slice = Array.prototype.slice;\nvar isArgs = require('./isArguments');\nvar isEnumerable = Object.prototype.propertyIsEnumerable;\nvar hasDontEnumBug = !isEnumerable.call({ toString: null }, 'toString');\nvar hasProtoEnumBug = isEnumerable.call(function () {}, 'prototype');\nvar dontEnums = [\n\t'toString',\n\t'toLocaleString',\n\t'valueOf',\n\t'hasOwnProperty',\n\t'isPrototypeOf',\n\t'propertyIsEnumerable',\n\t'constructor'\n];\nvar equalsConstructorPrototype = function (o) {\n\tvar ctor = o.constructor;\n\treturn ctor && ctor.prototype === o;\n};\nvar excludedKeys = {\n\t$console: true,\n\t$external: true,\n\t$frame: true,\n\t$frameElement: true,\n\t$frames: true,\n\t$innerHeight: true,\n\t$innerWidth: true,\n\t$outerHeight: true,\n\t$outerWidth: true,\n\t$pageXOffset: true,\n\t$pageYOffset: true,\n\t$parent: true,\n\t$scrollLeft: true,\n\t$scrollTop: true,\n\t$scrollX: true,\n\t$scrollY: true,\n\t$self: true,\n\t$webkitIndexedDB: true,\n\t$webkitStorageInfo: true,\n\t$window: true\n};\nvar hasAutomationEqualityBug = (function () {\n\t/* global window */\n\tif (typeof window === 'undefined') { return false; }\n\tfor (var k in window) {\n\t\ttry {\n\t\t\tif (!excludedKeys['$' + k] && has.call(window, k) && window[k] !== null && typeof window[k] === 'object') {\n\t\t\t\ttry {\n\t\t\t\t\tequalsConstructorPrototype(window[k]);\n\t\t\t\t} catch (e) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (e) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}());\nvar equalsConstructorPrototypeIfNotBuggy = function (o) {\n\t/* global window */\n\tif (typeof window === 'undefined' || !hasAutomationEqualityBug) {\n\t\treturn equalsConstructorPrototype(o);\n\t}\n\ttry {\n\t\treturn equalsConstructorPrototype(o);\n\t} catch (e) {\n\t\treturn false;\n\t}\n};\n\nvar keysShim = function keys(object) {\n\tvar isObject = object !== null && typeof object === 'object';\n\tvar isFunction = toStr.call(object) === '[object Function]';\n\tvar isArguments = isArgs(object);\n\tvar isString = isObject && toStr.call(object) === '[object String]';\n\tvar theKeys = [];\n\n\tif (!isObject && !isFunction && !isArguments) {\n\t\tthrow new TypeError('Object.keys called on a non-object');\n\t}\n\n\tvar skipProto = hasProtoEnumBug && isFunction;\n\tif (isString && object.length > 0 && !has.call(object, 0)) {\n\t\tfor (var i = 0; i < object.length; ++i) {\n\t\t\ttheKeys.push(String(i));\n\t\t}\n\t}\n\n\tif (isArguments && object.length > 0) {\n\t\tfor (var j = 0; j < object.length; ++j) {\n\t\t\ttheKeys.push(String(j));\n\t\t}\n\t} else {\n\t\tfor (var name in object) {\n\t\t\tif (!(skipProto && name === 'prototype') && has.call(object, name)) {\n\t\t\t\ttheKeys.push(String(name));\n\t\t\t}\n\t\t}\n\t}\n\n\tif (hasDontEnumBug) {\n\t\tvar skipConstructor = equalsConstructorPrototypeIfNotBuggy(object);\n\n\t\tfor (var k = 0; k < dontEnums.length; ++k) {\n\t\t\tif (!(skipConstructor && dontEnums[k] === 'constructor') && has.call(object, dontEnums[k])) {\n\t\t\t\ttheKeys.push(dontEnums[k]);\n\t\t\t}\n\t\t}\n\t}\n\treturn theKeys;\n};\n\nkeysShim.shim = function shimObjectKeys() {\n\tif (Object.keys) {\n\t\tvar keysWorksWithArguments = (function () {\n\t\t\t// Safari 5.0 bug\n\t\t\treturn (Object.keys(arguments) || '').length === 2;\n\t\t}(1, 2));\n\t\tif (!keysWorksWithArguments) {\n\t\t\tvar originalKeys = Object.keys;\n\t\t\tObject.keys = function keys(object) {\n\t\t\t\tif (isArgs(object)) {\n\t\t\t\t\treturn originalKeys(slice.call(object));\n\t\t\t\t} else {\n\t\t\t\t\treturn originalKeys(object);\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t} else {\n\t\tObject.keys = keysShim;\n\t}\n\treturn Object.keys || keysShim;\n};\n\nmodule.exports = keysShim;\n","module.exports = function (xs, f) {\n    if (xs.map) return xs.map(f);\n    var res = [];\n    for (var i = 0; i < xs.length; i++) {\n        var x = xs[i];\n        if (hasOwn.call(xs, i)) res.push(f(x, i, xs));\n    }\n    return res;\n};\n\nvar hasOwn = Object.prototype.hasOwnProperty;\n","'use strict'\n\nimport angular from 'angular'\nimport service from './service'\nimport httpDecorator from './httpDecorator'\nimport httpInterceptor from './httpInterceptor'\nimport cacheServiceAdapters from './cacheServiceAdapters'\n\nvar _$provide\n\nexport default angular\n  .module('http-etag', [])\n  .provider('httpEtag', service)\n  .config(cacheServiceAdapters)\n  .config(['$provide', '$httpProvider', function addHttpEtagInterceptor ($provide, $httpProvider) {\n    _$provide = $provide\n    $httpProvider.interceptors.push(httpInterceptor)\n  }])\n  .run(function decorateHttpService () {\n    _$provide.decorator('$http', httpDecorator)\n  })\n  .name\n"],"names":["httpEtagProvider","this","serviceAdapterMethods","cacheAdapterMethods","requiredAdapterMethods","concat","cacheAdapters","cacheDefinitions","defaultCacheId","defaultEtagCacheConfig","deepCopy","cacheResponseData","cacheService","cacheOptions","number","setDefaultCacheConfig","config","angular","extend","getDefaultCacheConfig","defineCache","cacheId","id","defineCacheServiceAdapter","serviceName","Error","methods","forEach","method","getCacheServiceAdapter","$get","$injector","processCacheId","type","isDefined","httpEtagService","services","adaptedServices","caches","adaptedCaches","adapter","service","window","get","adaptedService","bind","createCache","cache","getCache","adaptedCache","serviceDeepCopies","storesDeepCopies","copy","value","deepcopy","wrappedMethod","wrappedRawMethod","adapterMethod","itemKey","options","cachedData","responseData","$getItem","unsetItem","setItem","undefined","expireItem","data","etagHeader","$setItem","getItemCache","info","isCache","itemCache","methodMappings","itemCacheInfo","isItemCache","purgeCaches","removeAllItems","httpEtagHttpDecorator","$delegate","httpEtag","$httpDecorator","httpConfig","httpPromise","hasConfig","etagCache","isCacheableMethod","cachableHttpMethods","indexOf","isCachable","etagCacheConfig","processHttpConfigEtagValue","cacheInfo","rawCacheData","cachedEtag","cachedResponse","$$_itemCache","headers","If-None-Match","$http","apply","arguments","cached","callback","onSuccess","success","partializedCallback","partial","etagValue","etagValueType","generateCacheItemKey","url","params","stringifyParams","joiner","queryString","obj","arrayMap","objectKeys","sort","key","val","isArray","val2","encodeURIComponent","join","fn","args","Array","prototype","slice","call","arg","i","length","httpMethod","toLowerCase","httpEtagInterceptorFactory","responseInterceptor","response","etag","cacheData","$set","cacheAdaptersConfig","$cacheFactory","put","getItem","removeItem","remove","removeAll","noop","localStorage","JSON","stringify","parse","keyPrefix","sessionStorage","array","s","toString","TypeError","len","exports","__esModule","Object","isBuffer","Buffer","getKeys","keys","objType","resultKeys","hasOwnProperty","push","getSymbols","Symbol","getOwnPropertySymbols","target","customizer","resultValue","copyValue","copyCollection","source","String","test","Function","targetClass","constructor","Date","getTime","regexpText","slashIndex","lastIndexOf","RegExp","_polyfill","buffer","customizerResult","targetType","commonjsHelpers.interopDefault","defaultCustomizer","_copy","resultCollection","clone","visited","reference","recursiveCopy","index","resultCopy","result","ref","module","toStr","str","isArgs","callee","has","isEnumerable","propertyIsEnumerable","hasDontEnumBug","hasProtoEnumBug","dontEnums","equalsConstructorPrototype","o","ctor","excludedKeys","$console","$external","$frame","$frameElement","$frames","$innerHeight","$innerWidth","$outerHeight","$outerWidth","$pageXOffset","$pageYOffset","$parent","$scrollLeft","$scrollTop","$scrollX","$scrollY","$self","$webkitIndexedDB","$webkitStorageInfo","$window","hasAutomationEqualityBug","k","e","equalsConstructorPrototypeIfNotBuggy","keysShim","object","isObject","isFunction","isArguments","isString","theKeys","skipProto","j","name","skipConstructor","shim","keysWorksWithArguments","originalKeys","xs","f","map","res","x","hasOwn","$inject","_$provide","provider","cacheServiceAdapters","$provide","$httpProvider","interceptors","httpInterceptor","run","decorator","httpDecorator"],"mappings":"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"}